(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[47238],{487959:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>z});var o=r(621413),n=r(973410),i=r(473392),a=r(701577),l=r(372445),s=r(169141),u=r(831219),c=r(409371),d=r(898185),f=r(120767),y=r(552329),p=r(869669),h=r(15265),g=r(752043),m=r(944538),v=r(870295),_=r(218672),w=r(196975),b=r(798090),P=r(186977),O=r(717621),S=r.n(O),F=r(436403),j=r(854788);function C(e){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C(e)}function Z(e){return function(e){if(Array.isArray(e))return x(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||k(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function G(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,L(o.key),o)}}function E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function A(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?E(Object(r),!0).forEach((function(t){T(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function T(e,t,r){return(t=L(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function L(e){var t=function(e){if("object"!=C(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=C(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==C(t)?t:t+""}function D(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var o,n,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(o=i.call(r)).done)&&(l.push(o.value),l.length!==t);s=!0);}catch(e){u=!0,n=e}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw n}}return l}}(e,t)||k(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,t){if(e){if("string"==typeof e)return x(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?x(e,t):void 0}}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=Array(t);r<t;r++)o[r]=e[r];return o}var I=new s.Z,M=function(e,t){var r=e.getView().getProjection().getCode();return(0,w.transformLineToArcs)(t.map((function(e){var t=(0,w.reproject)(e,r,"EPSG:4326");return[t.x,t.y]}))).map((function(e){var t=(0,w.reproject)(e,"EPSG:4326",r);return[t.x,t.y]}))};function R(e){return e.find((function(e){return void 0!==e[2]}))?e.map((function(e){var t=D(e,3),r=t[0],o=t[1],n=t[2];return[r,o,void 0===n?0:n]})):e}function N(e){var t=null==e?void 0:e.type;return"Point"===t?{type:"Point",coordinates:R([e.coordinates])[0]}:"LineString"===t?{type:"LineString",coordinates:R(e.coordinates)}:"Polygon"===t?{type:"Polygon",coordinates:e.coordinates.map(R)}:e}function J(e){var t=e.map,r=e.olFeature,o=e.feature,n=e.modifyPropertiesToFeatureProperties,i=void 0===n?function(){return{}}:n,a=t.getView().getProjection().getCode(),l=r.clone(),s=l.get("@properties")||{},u=s.geometryType;if("Circle"===u&&l.getGeometry()instanceof p.Z&&(s=A(A({},s),{},{radius:l.getGeometry().getRadius()}),l.setGeometry(new g.Z(l.getGeometry().getCenter()))),"Circle"===u&&l.getGeometry()instanceof b.Z){s=A(A({},s),l.get("@properties"));var c=l.getGeometry().getGeometries();l.setGeometry(c[c.length-1].clone())}var d=I.writeFeatureObject(l,{featureProjection:a,dataProjection:"EPSG:4326"}).geometry;return A(A({},o),{},{geometry:N(d),properties:i(s,o)})}function V(e,t){if(void 0===t)return e;var r=S()(e).toRgb(),o=r.r,n=r.g,i=r.b;return"rgba(".concat([o,n,i,t].join(", "),")")}const q=function(){return e=function e(){var t,r,o=this,d=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),T(this,"_onSingleClick",(function(){o._draw&&!o._draw.active&&(o._draw.setActive(!0),o._modify.setActive(!1))})),this._map=d.map;var y=d.geojson;this._featureToModifyProperties=(0,j.cC)({getGeometryType:null==d?void 0:d.getGeometryType});var p=j.r2,g=d.onEditEnd?d.onEditEnd:function(){},w=(0,j.E4)(d.style),b=!!d.enablePolygonHoles,O=!1,S=new n.Z({wrapX:!1,format:new s.Z,features:[]});this._layer=new i.Z({source:S,style:this._createStyleFunction({map:this._map,style:w}),zIndex:1/0}),this.setGeoJSON(y),this._modify=new a.Z({source:S,style:function(e){var t,r,n,i;return e.get("features").forEach((function(t){var r=t.get("@modifyGeometry"),n=t.get("@properties")||{},i=n.geometryType,a=n.radius;if(r&&"Circle"===i){var l,s,u=e.getGeometry().getCoordinates(),c=t.getGeometry().getGeometries(),d=c[1].getCoordinates(),f=o._map.getView().getProjection(),y=a;u[0]===d[0]&&u[1]===d[1]||(l=(0,_.vs)(d,f,"EPSG:4326"),s=(0,_.vs)(u,f,"EPSG:4326"),y=(0,v.Sp)(l,s));var p=(0,h.iu)((0,_.vs)(d,f,"EPSG:4326"),y,128);p.transform("EPSG:4326",f),c[0].setCoordinates(p.getCoordinates()),r.setGeometries(c),t.set("@properties",A(A({},t.get("@properties")),{},{radius:y}))}})),new u.ZP({image:new c.Z({stroke:new f.Z({color:V(null==w||null===(t=w.cursor)||void 0===t?void 0:t.color,null==w||null===(r=w.cursor)||void 0===r?void 0:r.opacity),width:null==w||null===(n=w.cursor)||void 0===n?void 0:n.width}),radius:null==w||null===(i=w.cursor)||void 0===i?void 0:i.radius})})}}),this._modify.on("modifystart",(function(e){e.features.forEach((function(e){var t=e.getGeometry();"GeometryCollection"===t.getType()&&e.set("@modifyGeometry",t.clone(),!0)}))})),this._modify.on("modifyend",(function(e){e.features.forEach((function(e){var t=e.get("@modifyGeometry");t&&(e.setGeometry(t),e.unset("@modifyGeometry",!0))})),g(o._normalizeGeoJSONResult((function(t){var r=e.features.getArray().find((function(e){return e.getId()===t.id}));return r?J({map:o._map,olFeature:r,feature:t,modifyPropertiesToFeatureProperties:p}):t})))})),this._map.addInteraction(this._modify),this._map.addLayer(this._layer),this._map.on("singleclick",this._onSingleClick),"LineString"===(null==y||null===(t=y.geometry)||void 0===t?void 0:t.type)&&(this._draw=new l.ZP({type:"LineString",stopClick:!0,freehandCondition:F.Fi,style:function(e){var t,r,n,i,a,l,s,d,y,p,h,g,v=D(S.getFeatures(),1)[0],_=(v.get("@properties")||{}).geodesic,b=v.getGeometry().getCoordinates(),P=e.getGeometry().get("@coordinates"),F=!O&&[b[b.length-1],e.getGeometry().getCoordinates()],j=P||F;return[].concat(Z(j?[new u.ZP({geometry:new m.Z(j),stroke:new f.Z(A({color:V(null==w||null===(t=w.lineDrawing)||void 0===t?void 0:t.color,null==w||null===(r=w.lineDrawing)||void 0===r?void 0:r.opacity),width:null==w||null===(n=w.lineDrawing)||void 0===n?void 0:n.width},(null==w||null===(i=w.lineDrawing)||void 0===i?void 0:i.dashLength)&&{lineDash:[w.lineDrawing.dashLength]}))})].concat(Z(_?[new u.ZP({geometry:new m.Z(M(o._map,j)),stroke:new f.Z(A({color:V(null==w||null===(a=w.line)||void 0===a?void 0:a.color,null==w||null===(l=w.line)||void 0===l?void 0:l.opacity),width:null==w||null===(s=w.line)||void 0===s?void 0:s.width},(null==w||null===(d=w.line)||void 0===d?void 0:d.dashLength)&&{lineDash:[w.line.dashLength]}))})]:[])):[]),[new u.ZP({image:new c.Z({stroke:new f.Z({color:V(null==w||null===(y=w.cursor)||void 0===y?void 0:y.color,null==w||null===(p=w.cursor)||void 0===p?void 0:p.opacity),width:null==w||null===(h=w.cursor)||void 0===h?void 0:h.width}),radius:null==w||null===(g=w.cursor)||void 0===g?void 0:g.radius})})])},geometryFunction:function(e,t){var r=t,o=D(S.getFeatures(),1)[0];r||(r=new m.Z([]));var n=o.getGeometry().getCoordinates();return r.setCoordinates([].concat(Z(n),Z(e))),r.set("@coordinates",[n[n.length-1]].concat(Z(e))),r}}),this._map.addInteraction(this._draw),this._draw.setActive(!1),this._draw.on("drawstart",(function(){(O=!O)||(o._draw.setActive(!1),o._modify.setActive(!0))})),this._draw.on("drawend",(function(e){o._draw.setActive(!1),o._modify.setActive(!0),O=!1,g(o._normalizeGeoJSONResult((function(t){return J({map:o._map,olFeature:e.feature,feature:t,modifyPropertiesToFeatureProperties:p})})))}))),"Polygon"===(null==y||null===(r=y.geometry)||void 0===r?void 0:r.type)&&b&&(this._draw=new P.Z({type:"Polygon",stopClick:!0,style:function(e){var t,r,n,i;return"Point"===e.getGeometry().getType()?new u.ZP({image:new c.Z({stroke:new f.Z({color:V(null==w||null===(t=w.cursor)||void 0===t?void 0:t.color,null==w||null===(r=w.cursor)||void 0===r?void 0:r.opacity),width:null==w||null===(n=w.cursor)||void 0===n?void 0:n.width}),radius:null==w||null===(i=w.cursor)||void 0===i?void 0:i.radius})}):o._createStyleFunction({map:o._map,style:w})(e)}}),this._map.addInteraction(this._draw),this._draw.setActive(!1),this._draw.on("drawstart",(function(){O=!0})),this._draw.on("drawend",(function(e){o._draw.setActive(!1),o._modify.setActive(!0),O=!1,g(o._normalizeGeoJSONResult((function(t){return e.feature.getId()===t.id?J({map:o._map,olFeature:e.feature,feature:t,modifyPropertiesToFeatureProperties:p}):t})))})))},(t=[{key:"setGeoJSON",value:function(e){var t=this;this._layer&&(this._geojson=A({},e),this._features="Feature"===(null==e?void 0:e.type)?[e]:null==e?void 0:e.features,this._layer.getSource().clear(),this._layer.getSource().addFeatures(this._features.map((function(e){return function(e){var t=e.feature,r=e.featureToModifyProperties,o=void 0===r?function(){return{}}:r,n=e.map.getView().getProjection().getCode(),i=I.readFeature(t,{featureProjection:n,dataProjection:"EPSG:4326"}),a=o(t),l=a.geodesic,s=a.geometryType,u=a.radius;if(i.set("@properties",a),l&&"Circle"===s&&u){var c=(0,h.iu)(t.geometry.coordinates,u,128).transform("EPSG:4326",n).getCoordinates();return i.setGeometry(new b.Z([new h.ZP(c),i.getGeometry()])),i}if("Circle"===s&&u){var d=i.getGeometry().clone();i.set("@geometry",d),i.setGeometry(new p.Z(d.getCoordinates(),u))}return i}({map:t._map,feature:e,featureToModifyProperties:t._featureToModifyProperties})}))))}},{key:"remove",value:function(){this._modify&&(this._map.removeInteraction(this._modify),this._modify=null),this._draw&&(this._map.removeInteraction(this._draw),this._draw=null),this._layer&&(this._map.removeLayer(this._layer),this._layer=null),this._onSingleClick&&this._map.un("singleclick",this._onSingleClick)}},{key:"_normalizeGeoJSONResult",value:function(e){var t,r=this._features.map(e);return"Feature"===(null===(t=this._geojson)||void 0===t?void 0:t.type)?r[0]:{type:"FeatureCollection",features:r}}},{key:"_createStyleFunction",value:function(e){var t=e.map,r=e.style;return function(e){var o,n,i,a,l,s,p,g,v,_,w,b,P,O,S,F,j=e.getGeometry().getType(),C=e.get("@properties")||{},G=C.geodesic,E=C.geometryType,T=new c.Z({stroke:new f.Z({color:V(null==r||null===(o=r.coordinatesNode)||void 0===o?void 0:o.color,null==r||null===(n=r.coordinatesNode)||void 0===n?void 0:n.opacity),width:null==r||null===(i=r.coordinatesNode)||void 0===i?void 0:i.width}),radius:null==r||null===(a=r.coordinatesNode)||void 0===a?void 0:a.radius}),L=new f.Z(A({color:V(null==r||null===(l=r.line)||void 0===l?void 0:l.color,null==r||null===(s=r.line)||void 0===s?void 0:s.opacity),width:null==r||null===(p=r.line)||void 0===p?void 0:p.width},(null==r||null===(g=r.line)||void 0===g?void 0:g.dashLength)&&{lineDash:[r.line.dashLength]})),D=new f.Z(A({color:V(null==r||null===(v=r.lineDrawing)||void 0===v?void 0:v.color,null==r||null===(_=r.lineDrawing)||void 0===_?void 0:_.opacity),width:null==r||null===(w=r.lineDrawing)||void 0===w?void 0:w.width},(null==r||null===(b=r.lineDrawing)||void 0===b?void 0:b.dashLength)&&{lineDash:[r.lineDrawing.dashLength]})),k=new d.Z({color:V(null==r||null===(P=r.areaDrawing)||void 0===P?void 0:P.color,null==r||null===(O=r.areaDrawing)||void 0===O?void 0:O.opacity)}),x=new d.Z({color:V(null==r||null===(S=r.area)||void 0===S?void 0:S.color,null==r||null===(F=r.area)||void 0===F?void 0:F.opacity)});return G&&"Circle"===E&&"GeometryCollection"===j?[new u.ZP({geometry:e.get("@modifyGeometry")||e.getGeometry(),stroke:D,fill:k}),new u.ZP({geometry:e.get("@geometry"),image:T})]:"Circle"===j?[new u.ZP({stroke:D,fill:k}),new u.ZP({geometry:e.get("@geometry"),image:T})]:"LineString"===j?[new u.ZP(A(A({},G&&{geometry:new m.Z(M(t,e.getGeometry().getCoordinates()))}),{},{stroke:G?L:D}))].concat(Z(G?[new u.ZP({stroke:D})]:[]),[new u.ZP({geometry:new y.Z(e.getGeometry().getCoordinates()),image:T})]):"Polygon"===j?[new u.ZP(A(A({},G&&{geometry:new h.ZP(e.getGeometry().getCoordinates().map((function(e){return M(t,e)})))}),{},{stroke:G?L:D,fill:G?x:k}))].concat(Z(G?[new u.ZP({stroke:D})]:[]),[new u.ZP({geometry:new y.Z(e.getGeometry().getCoordinates().reduce((function(e,t){return[].concat(Z(e),Z(t))}),[])),image:T})]):new u.ZP({image:T})}}}])&&G(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}(),z=function(e){var t=e.map,r=e.active,n=e.geojson,i=e.onEditEnd,a=e.style,l=e.enablePolygonHoles,s=void 0!==l&&l,u=e.getGeometryType,c=(0,o.useRef)();return(0,o.useEffect)((function(){return t&&r&&(c.current=new q({map:t,geojson:n,getGeometryType:u,onEditEnd:i,style:a,enablePolygonHoles:s})),function(){c.current&&(c.current.remove(),c.current=null)}}),[t,r,s]),(0,o.useEffect)((function(){c.current&&c.current.setGeoJSON(n)}),[n]),null}},854788:(e,t,r)=>{"use strict";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function a(e,t,r){return(t=function(e){var t=function(e){if("object"!=o(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==o(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e){return i({wireframe:{color:"#000000",opacity:1,depthFailColor:"#000000",depthFailOpacity:.4,width:.5},lineDrawing:{color:"#000000",opacity:1,depthFailColor:"#000000",depthFailOpacity:.4,width:3,dashLength:8},line:{color:"#ffcc33",opacity:1,depthFailColor:"#ffcc33",depthFailOpacity:.4,width:2},areaDrawing:{color:"#ffffff",opacity:.5,depthFailColor:"#ffffff",depthFailOpacity:.25},area:{color:"#ffffff",opacity:.5,depthFailColor:"#ffffff",depthFailOpacity:.25},cursor:{color:"#ff0000",width:2,radius:4},coordinatesNode:{color:"#333333",width:2,radius:5}},e)}r.d(t,{E4:()=>l,cC:()=>u,r2:()=>c});var s=function(e){var t;return null==e||null===(t=e.geometry)||void 0===t?void 0:t.type},u=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).getGeometryType,t=void 0===e?s:e;return function(e){return i(i({},null==e?void 0:e.properties),{},{geometryType:t(e)})}},c=function(e,t){return i(i({},null==t?void 0:t.properties),void 0!==(null==e?void 0:e.radius)&&{radius:e.radius})}},186977:(e,t,r)=>{"use strict";r.d(t,{Z:()=>g});var o=r(15265),n=r(513987),i=r(562948),a=r(372445),l=r(51273);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){p(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function d(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(d=function(){return!!e})()}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},f(e)}function y(e,t){return y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},y(e,t)}function p(e,t,r){return(t=h(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function h(e){var t=function(e){if("object"!=s(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==s(t)?t:t+""}const g=function(e){function t(e){var r;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),p(r=function(e,t,r){return t=f(t),function(e,t){if(t&&("object"==s(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,d()?Reflect.construct(t,r||[],f(e).constructor):t.apply(e,r))}(this,t,[c(c({},e),{},{type:"Polygon",geometryFunction:e.geometryFunction?function(t,o){return e.geometryFunction(t,r._geometryFn(t,o))}:function(e,t){return r._geometryFn(e,t)}})]),"setMap",(function(e){this.getMap()&&this.getMap().removeInteraction(this._select),e&&e.addInteraction(this._select),a.ZP.prototype.setMap.call(this,e)})),p(r,"setActive",(function(e){this._select.getFeatures().clear(),a.ZP.prototype.setActive.call(this,e)})),p(r,"removeLastPoint",(function(){this._feature&&this._feature.getGeometry().getCoordinates()[0].length>2&&a.ZP.prototype.removeLastPoint.call(this)})),p(r,"getPolygon",(function(){return this._polygon})),p(r,"_startDrawing",(function(e){var t=this.getMap();this._feature=e.feature;var r=e.feature.getGeometry().getCoordinates()[0][0];this._current=null,t.forEachFeatureAtPixel(t.getPixelFromCoordinate(r),function(e,t){if(!this._current&&this._features(e,t)){var o=e.getGeometry();if("Polygon"===o.getType()&&o.intersectsCoordinate(r))this._polygonIndex=!1,this._polygon=o,this._current=e;else if("MultiPolygon"===o.getType()&&o.intersectsCoordinate(r))for(var n,i=0;o.getPolygon(i);i++)if((n=o.getPolygon(i)).intersectsCoordinate(r)){this._polygonIndex=i,this._polygon=n,this._current=e;break}}}.bind(this),{layerFilter:this.layers_}),this._select.getFeatures().clear(),this._current?this._select.getFeatures().push(this._current):(this.setActive(!1),this.setActive(!0))})),p(r,"_finishDrawing",(function(e){e.hole=e.feature,e.feature=this._select.getFeatures().item(0),this.dispatchEvent({type:"modifystart",features:[this._current]});var t=e.hole.getGeometry().getCoordinates()[0];if(t.length>=3)if(!1!==this._polygonIndex){for(var r,o=e.feature.getGeometry(),a=new n.Z([]),l=0;o.getPolygon(l);l++)r=o.getPolygon(l),l===this._polygonIndex?(r.appendLinearRing(new i.Z(t)),a.appendPolygon(r)):a.appendPolygon(r);e.feature.setGeometry(a)}else this.getPolygon().appendLinearRing(new i.Z(t));this.dispatchEvent({type:"modifyend",features:[this._current]}),this._feature=null,this._select.getFeatures().clear()})),p(r,"_geometryFn",(function(e,t){var r=e[0].pop();return this.getPolygon()&&!this.getPolygon().intersectsCoordinate(r)||(this.lastOKCoord=[r[0],r[1]]),e[0].push([this.lastOKCoord[0],this.lastOKCoord[1]]),t&&t.setCoordinates([e[0].concat([e[0][0]])]),new o.ZP(e)})),r._select=new l.Z({style:e.style}),r._select.setActive(!1),e.layers&&("function"==typeof e.layers?r.layers_=e.layers:e.layers.indexOf&&(r.layers_=function(t){return e.layers.indexOf(t)>=0})),"function"==typeof e.featureFilter)r._features=e.featureFilter;else if(e.featureFilter){var u=e.featureFilter;r._features=function(e){return u.indexOf?!!u[u.indexOf(e)]:!!u.item(u.getArray().indexOf(e))}}else r._features=function(){return!0};return r.on("drawstart",r._startDrawing.bind(r)),r.on("drawend",r._finishDrawing.bind(r)),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}(t,e),r=t,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(a.ZP)},51273:(e,t,r)=>{"use strict";r.d(t,{Z:()=>v});var o=r(378426),n=r(919629),i=r(9520),a=r(623068),l=r(247588),s=r(473392),u=r(864011),c=r(913580),d=r(831219),f=r(179682),y=r(949179),p=r(436403);class h extends i.ZP{constructor(e,t,r,o){super(e),this.selected=t,this.deselected=r,this.mapBrowserEvent=o}}const g={};class m extends l.ZP{constructor(e){let t;if(super(),this.on,this.once,this.un,e=e||{},this.boundAddFeature_=this.addFeature_.bind(this),this.boundRemoveFeature_=this.removeFeature_.bind(this),this.condition_=e.condition?e.condition:p.Kf,this.addCondition_=e.addCondition?e.addCondition:p.Fi,this.removeCondition_=e.removeCondition?e.removeCondition:p.Fi,this.toggleCondition_=e.toggleCondition?e.toggleCondition:p.vY,this.multi_=!!e.multi&&e.multi,this.filter_=e.filter?e.filter:u.uX,this.hitTolerance_=e.hitTolerance?e.hitTolerance:0,this.style_=void 0!==e.style?e.style:function(){const e=(0,d.Ly)();return(0,f.l7)(e.Polygon,e.LineString),(0,f.l7)(e.GeometryCollection,e.LineString),function(t){return t.getGeometry()?e[t.getGeometry().getType()]:null}}(),this.features_=e.features||new o.Z,e.layers)if("function"==typeof e.layers)t=e.layers;else{const r=e.layers;t=function(e){return r.includes(e)}}else t=u.uX;this.layerFilter_=t,this.featureLayerAssociation_={}}addFeatureLayerAssociation_(e,t){this.featureLayerAssociation_[(0,y.sq)(e)]=t}getFeatures(){return this.features_}getHitTolerance(){return this.hitTolerance_}getLayer(e){return this.featureLayerAssociation_[(0,y.sq)(e)]}setHitTolerance(e){this.hitTolerance_=e}setMap(e){this.getMap()&&this.style_&&this.features_.forEach(this.restorePreviousStyle_.bind(this)),super.setMap(e),e?(this.features_.addEventListener(n.Z.ADD,this.boundAddFeature_),this.features_.addEventListener(n.Z.REMOVE,this.boundRemoveFeature_),this.style_&&this.features_.forEach(this.applySelectedStyle_.bind(this))):(this.features_.removeEventListener(n.Z.ADD,this.boundAddFeature_),this.features_.removeEventListener(n.Z.REMOVE,this.boundRemoveFeature_))}addFeature_(e){const t=e.element;if(this.style_&&this.applySelectedStyle_(t),!this.getLayer(t)){const e=this.getMap().getAllLayers().find((function(e){if(e instanceof s.Z&&e.getSource()&&e.getSource().hasFeature(t))return e}));e&&this.addFeatureLayerAssociation_(t,e)}}removeFeature_(e){this.style_&&this.restorePreviousStyle_(e.element)}getStyle(){return this.style_}applySelectedStyle_(e){const t=(0,y.sq)(e);t in g||(g[t]=e.getStyle()),e.setStyle(this.style_)}restorePreviousStyle_(e){const t=this.getMap().getInteractions().getArray();for(let r=t.length-1;r>=0;--r){const o=t[r];if(o!==this&&o instanceof m&&o.getStyle()&&-1!==o.getFeatures().getArray().lastIndexOf(e))return void e.setStyle(o.getStyle())}const r=(0,y.sq)(e);e.setStyle(g[r]),delete g[r]}removeFeatureLayerAssociation_(e){delete this.featureLayerAssociation_[(0,y.sq)(e)]}handleEvent(e){if(!this.condition_(e))return!0;const t=this.addCondition_(e),r=this.removeCondition_(e),o=this.toggleCondition_(e),n=!t&&!r&&!o,i=e.map,l=this.getFeatures(),s=[],u=[];if(n){(0,c.Z)(this.featureLayerAssociation_),i.forEachFeatureAtPixel(e.pixel,((e,t)=>{if(e instanceof a.Z&&this.filter_(e,t))return this.addFeatureLayerAssociation_(e,t),u.push(e),!this.multi_}),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let e=l.getLength()-1;e>=0;--e){const t=l.item(e),r=u.indexOf(t);r>-1?u.splice(r,1):(l.remove(t),s.push(t))}0!==u.length&&l.extend(u)}else{i.forEachFeatureAtPixel(e.pixel,((e,n)=>{if(e instanceof a.Z&&this.filter_(e,n))return!t&&!o||l.getArray().includes(e)?(r||o)&&l.getArray().includes(e)&&(s.push(e),this.removeFeatureLayerAssociation_(e)):(this.addFeatureLayerAssociation_(e,n),u.push(e)),!this.multi_}),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let e=s.length-1;e>=0;--e)l.remove(s[e]);l.extend(u)}return(u.length>0||s.length>0)&&this.dispatchEvent(new h("select",u,s,e)),!0}}const v=m}}]);