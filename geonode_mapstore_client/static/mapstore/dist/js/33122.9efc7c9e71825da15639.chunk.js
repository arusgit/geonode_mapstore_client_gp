(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[33122],{894417:(e,t,r)=>{"use strict";r.d(t,{Z:()=>u});var n=r(427244),i=r(55608);function o(e,t,r){if(void 0===r&&(r={}),!0===r.final)return function(e,t){var r=o(t,e);return(r+180)%360}(e,t);var a=(0,i.c9)(e),l=(0,i.c9)(t),u=(0,n.Ht)(a[0]),s=(0,n.Ht)(l[0]),c=(0,n.Ht)(a[1]),m=(0,n.Ht)(l[1]),y=Math.sin(s-u)*Math.cos(m),p=Math.cos(c)*Math.sin(m)-Math.sin(c)*Math.cos(m)*Math.cos(s-u);return(0,n.vi)(Math.atan2(y,p))}function a(e,t,r,o){void 0===o&&(o={});var a=(0,i.c9)(e),l=(0,n.Ht)(a[0]),u=(0,n.Ht)(a[1]),s=(0,n.Ht)(r),c=(0,n.lF)(t,o.units),m=Math.asin(Math.sin(u)*Math.cos(c)+Math.cos(u)*Math.sin(c)*Math.cos(s)),y=l+Math.atan2(Math.sin(s)*Math.sin(c)*Math.cos(u),Math.cos(c)-Math.sin(u)*Math.sin(m)),p=(0,n.vi)(y),d=(0,n.vi)(m);return(0,n.xm)([p,d],o.properties)}var l=r(779928);function u(e,t,r){void 0===r&&(r={});for(var u=(0,i.wA)(e).coordinates,s=0,c=0;c<u.length&&!(t>=s&&c===u.length-1);c++){if(s>=t){var m=t-s;if(m){var y=o(u[c],u[c-1])-180;return a(u[c],m,y,r)}return(0,n.xm)(u[c])}s+=(0,l.Z)(u[c],u[c+1],r)}return(0,n.xm)(u[u.length-1])}},185447:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(798574);var i=r(427244);const o=function(e,t){if(t=t||{},!(0,i.Kn)(t))throw new Error("options is invalid");var r=t.properties;if(!e)throw new Error("geojson is required");var o=function(e){var t=[1/0,1/0,-1/0,-1/0];return(0,n.pZ)(e,(function(e){t[0]>e[0]&&(t[0]=e[0]),t[1]>e[1]&&(t[1]=e[1]),t[2]<e[0]&&(t[2]=e[0]),t[3]<e[1]&&(t[3]=e[1])})),t}(e),a=(o[0]+o[2])/2,l=(o[1]+o[3])/2;return(0,i.xm)([a,l],r)}},779928:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(55608),i=r(427244);const o=function(e,t,r){void 0===r&&(r={});var o=(0,n.c9)(e),a=(0,n.c9)(t),l=(0,i.Ht)(a[1]-o[1]),u=(0,i.Ht)(a[0]-o[0]),s=(0,i.Ht)(o[1]),c=(0,i.Ht)(a[1]),m=Math.pow(Math.sin(l/2),2)+Math.pow(Math.sin(u/2),2)*Math.cos(s)*Math.cos(c);return(0,i.DL)(2*Math.atan2(Math.sqrt(m),Math.sqrt(1-m)),r.units)}},664632:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(779928),i=r(798574);function o(e,t){return void 0===t&&(t={}),(0,i.hE)(e,(function(e,r){var i=r.geometry.coordinates;return e+(0,n.Z)(i[0],i[1],t)}),0)}},223502:(e,t,r)=>{"use strict";r.d(t,{$:()=>u,b:()=>s});var n=r(737275),i=r(701469),o=r.n(i),a=r(513218),l=r.n(a),u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(o()(e))return e.reduce((function(e,t){return u(t)&&e}),!0);var r=!1,i=!(0===e.indexOf("http")),a=!i&&e.match(/([^:]*:)\/\/([^:]*:?[^@]*@)?([^:\/\?]*):?([^\/\?]*)/);if(a){var s=window.location;i=a[1]===s.protocol&&a[3]===s.hostname;var c=a[4],m=s.port;(80!==c&&""!==c||"80"!==m&&""!==m)&&(i=i&&c===m)}if(!i){var y=n.ZP.getProxyUrl(t);if(y){var p=[];l()(y)&&(p=y.useCORS||[],y=y.url),p.reduce((function(t,r){return t||0===e.indexOf(r)}),!1)||(r=!0)}}return r},s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=n.ZP.getProxyUrl(e);return t&&l()(t)&&(t=t.url),t}},833122:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>fe});var n=r(330579),i=r(35961),o=r(312763),a=r(660904),l=r(532056),u=r(888340),s=r(11020),c=r(659635),m=r(720794),y=r(160629),p=r(218157),d=r(344485),f=r(405254),v=r(296541),g=r(990778),h=r(644001),T=r(205522),b=r(428709),O=r(730617),P=r(203547),Z=r(503939),C=r(65792),E=r.n(C),w=r(984596),S=r.n(w),L=r(281763),G=r.n(L),x=r(618446),M=r.n(x),H=r(396026),R=r.n(H),I=r(223502),j=r(830049),N=r(507122),A=r(976337),z=r(407578);function D(e){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},D(e)}var k=["msTranslateX","msTranslateY","msHeight"],F=["msGeometry"],_=["msGeometry"];function W(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,q(n.key),n)}}function B(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.includes(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.includes(r)||{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function U(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function V(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?U(Object(r),!0).forEach((function(t){Y(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Y(e,t,r){return(t=q(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function q(e){var t=function(e){if("object"!=D(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=D(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==D(t)?t:t+""}function X(e){return function(e){if(Array.isArray(e))return J(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||$(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $(e,t){if(e){if("string"==typeof e)return J(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?J(e,t):void 0}}function J(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var K=N.v.cesium({Cesium:n});function Q(e){var t=e.color,r=e.opacity;if(!t)return new i.Z(0,0,0,0);var n=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,l=[],u=!0,s=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);u=!0);}catch(e){s=!0,i=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw i}}return l}}(e,t)||$(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(E()(t).gl(),4),o=n[0],a=n[1],l=n[2],u=n[3];return void 0!==r?new i.Z(o,a,l,r):new i.Z(o,a,l,u)}function ee(e){var t=e.color,r=e.opacity,n=e.dasharray;if((null==n?void 0:n.length)<=0)return Q({color:t,opacity:r});var i=n.reduce((function(e,t){return e+t}),0);return new o.Z({color:Q({color:t,opacity:r}),dashLength:i,dashPattern:parseInt(n.map((function(e){return Math.floor(e/i*16)})).map((function(e,t){return R()(e).map((function(){return t%2==0?"1":"0"})).join("")})).join(""),2)})}var te=function(e){var t=parseFloat(e);return!isNaN(t)&&G()(t)?t:null},re=function(e){var t=e.map,r=e.positions,n=e.heightReference,i=e.sampleTerrain,o=e.initialHeight,c=null!=n?n:"none",m={none:function(e){return e},relative:function(e,t){return e+t},clamp:function(e,t){return t}},y=[],p=function(e){var t=m[c],r=1/0,n=-1/0,i=1/0,o=-1/0,l=e.map((function(e,l){var u=y[l]||0,s="none"===c?0:e.height||0,m=t(u,s);return r=m<r?m:r,n=m>n?m:n,i=s<i?s:i,o=s>o?s:o,a.Z.fromRadians(e.longitude,e.latitude,m)}));return{height:{min:r,max:n},sampledHeight:{min:i,max:o},positions:l}},d=r.map((function(e){var t,r=l.Z.fromCartesian(e);return y.push(null!==(t=null!=o?o:r.height)&&void 0!==t?t:0),new l.Z(r.longitude,r.latitude,null!=o?o:0)})),f=null==t?void 0:t.terrainProvider;return"none"!==c&&f?(f.ready?Promise.resolve(!0):f.readyPromise).then((function(){var e,t,r,n=null!=f&&f.availability?u.Z(f,d):i(f,null!==(e=null==f?void 0:f.sampleTerrainZoomLevel)&&void 0!==e?e:18,d);return s.Z(n)?null===(t=n.then((function(e){return p(e)})))||void 0===t||null===(r=t.catch)||void 0===r?void 0:r.call(t,(function(){return p(d)})):p(d)})):Promise.resolve(p(d))},ne={};function ie(e){var t=e.offset,r=void 0===t?[]:t,n=e.msLeaderLineWidth,i=null!=n?n:1,o=Math.abs(r[0]||1),a=Math.abs(r[1]||1),l=Math.sign(r[0])===Math.sign(r[1]),u=[o,a,i,l].join(";");if(ne[u])return ne[u];var s=document.createElement("canvas");s.setAttribute("width",o),s.setAttribute("height",a);var c=s.getContext("2d");return c.strokeStyle="#ffffff",c.lineWidth=i,c.beginPath(),c.moveTo.apply(c,X(l?[0,0]:[o,0])),c.lineTo.apply(c,X(l?[o,a]:[0,a])),c.stroke(),ne[u]=s,s}var oe=function(e,t){var r=t||{},n=r.msTranslateX,i=r.msTranslateY,o=te(n),l=te(i);return o||l?c.Z.multiplyByPoint(m.Z.eastNorthUpToFixedFrame(e),new a.Z(o||0,l||0,0),new a.Z):e},ae={none:"NONE",relative:"RELATIVE_TO_GROUND",clamp:"CLAMP_TO_GROUND"},le=function(e){switch(e){case"top-left":return{horizontalOrigin:y.Z.LEFT,verticalOrigin:p.Z.TOP};case"top":return{horizontalOrigin:y.Z.CENTER,verticalOrigin:p.Z.TOP};case"top-right":return{horizontalOrigin:y.Z.RIGHT,verticalOrigin:p.Z.TOP};case"left":return{horizontalOrigin:y.Z.LEFT,verticalOrigin:p.Z.CENTER};case"center":default:return{horizontalOrigin:y.Z.CENTER,verticalOrigin:p.Z.CENTER};case"right":return{horizontalOrigin:y.Z.RIGHT,verticalOrigin:p.Z.CENTER};case"bottom-left":return{horizontalOrigin:y.Z.LEFT,verticalOrigin:p.Z.BOTTOM};case"bottom":return{horizontalOrigin:y.Z.CENTER,verticalOrigin:p.Z.BOTTOM};case"bottom-right":return{horizontalOrigin:y.Z.RIGHT,verticalOrigin:p.Z.BOTTOM}}},ue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Square",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if("Circle"===e){for(var r=[],n=0;n<360;n++){var i=d.Z.toRadians(n);r.push(new f.Z(t*Math.cos(i),t*Math.sin(i)))}return r}return"Square"===e?[new f.Z(-t,-t),new f.Z(t,-t),new f.Z(t,t),new f.Z(-t,t)]:[]},se=function(e,t){var r=t||{},n=r.heading,i=r.pitch,o=r.roll;if(n||i||o){var a=new v.Z(d.Z.toRadians(null!=n?n:0),d.Z.toRadians(null!=i?i:0),d.Z.toRadians(null!=o?o:0));return m.Z.headingPitchRollQuaternion(e,a)}return null},ce=function(e,t){var r,n=t.radius,i=e;if(t.geodesic){var o=A.Z.computeEllipsePositions({granularity:.02,semiMajorAxis:n,semiMinorAxis:n,rotation:0,center:i},!1,!0).outerPositions;r=a.Z.unpackArray(o),r=[].concat(X(r),[r[0]])}else{var l=c.Z.multiplyByTranslation(m.Z.eastNorthUpToFixedFrame(i),new a.Z(0,0,0),new c.Z);r=z.Z.computePositions(0,n,n,128,!1),r=(r=X((r=a.Z.unpackArray(r)).splice(0,Math.ceil(r.length/2)))).map((function(e){return c.Z.multiplyByPoint(l,e,new a.Z)})),r=[].concat(X(r),[r[0]])}return r},me=function(e,t){var r=(t||{}).msHeight,n=te(r);if(null!==n){var i=l.Z.fromCartesian(e);return a.Z.fromRadians(i.longitude,i.latitude,n)}return e},ye={point:function(e){var t=e.feature,r=e.primitive,n=e.parsedSymbolizer;if("Point"===t.geometry.type){var i=me(t.positions[0][0],n),o=se(i,n);return V(V({},e),{},{primitive:V(V({},r),{},{orientation:o,geometry:oe(i,n)})})}var a=K(V({msGeometry:{name:"centerPoint"}},n))(t).position,l=se(a,n);return V(V({},e),{},{primitive:V(V({},r),{},{orientation:l,geometry:oe(me(a,n),n)})})},leaderLine:function(e,t){var r=t.map,n=t.sampleTerrain,i=e.parsedSymbolizer,o=(i.msTranslateX,i.msTranslateY,i.msHeight,B(i,k)),a=ye.point(V(V({},e),{},{parsedSymbolizer:o})).primitive;return Promise.all([re({map:r,positions:[a.geometry],heightReference:"clamp",sampleTerrain:n}).then((function(e){return e.positions[0]})),re({map:r,positions:[oe(me(a.geometry,i),i)],heightReference:i.msHeightReference,sampleTerrain:n}).then((function(e){return e.positions[0]}))]).then((function(t){return V(V({},e),{},{primitive:V(V({},a),{},{geometry:[t]})})}))},polyline:function(e,t){var r=t.map,n=t.sampleTerrain,i=e.feature,o=e.primitive,a=e.parsedSymbolizer,l=te(a.msExtrudedHeight),u=te(a.msHeight);if(null!==u||a.msExtrusionRelativeToGeometry){var s=1/0,c=-1/0;return Promise.all(null==i?void 0:i.positions.map((function(e){return re({map:r,positions:e,heightReference:a.msHeightReference,sampleTerrain:n,initialHeight:u}).then((function(e){var t=e[a.msExtrusionRelativeToGeometry?"height":"sampledHeight"];return s=t.min<s?t.min:s,c=t.max>c?t.max:c,e.positions}))}))).then((function(t){return V(V({},e),{},{primitive:V(V({},o),{},{geometry:t,extrudedHeight:l?l+(l>0?c:s):void 0})})}))}return V(V({},e),{},{primitive:V(V({},o),{},{geometry:null==i?void 0:i.positions},null!==l&&{extrudedHeight:l})})},wall:function(e,t){return Promise.resolve(ye.polyline(e,t)).then((function(t){var r,n,i=t.primitive;return V(V({},e),{},{primitive:V(V({},i),{},{geometry:null==i?void 0:i.geometry,minimumHeights:null==i||null===(r=i.geometry)||void 0===r?void 0:r.map((function(e){return e.map((function(e){return l.Z.fromCartesian(e).height}))})),maximumHeights:null==i||null===(n=i.geometry)||void 0===n?void 0:n.map((function(e){return e.map((function(){return i.extrudedHeight}))}))})})}))},polygon:function(e,t){var r,n,i=t.map,o=t.sampleTerrain,a=e.feature,l=e.primitive,u=e.parsedSymbolizer,s=te(u.msExtrudedHeight),c=te(u.msHeight);if("none"!==(u.msHeightReference||"none")||u.msExtrusionRelativeToGeometry){var m=1/0,y=-1/0;return Promise.all(null==a?void 0:a.positions.map((function(e){return re({map:i,positions:e,heightReference:u.msHeightReference,sampleTerrain:o,initialHeight:c}).then((function(e){var t=e[u.msExtrusionRelativeToGeometry?"height":"sampledHeight"];return m=t.min<m?t.min:m,y=t.max>y?t.max:y,e.positions}))}))).then((function(t){var r,n,i={height:void 0,extrudedHeight:s?s+(s>0?y:m):void 0};return V(V({},e),{},{primitive:V(V({},l),{},{geometry:t},null!=l&&null!==(r=l.entity)&&void 0!==r&&r.polygon?{entity:{polygon:V(V({},null==l||null===(n=l.entity)||void 0===n?void 0:n.polygon),i)}}:i)})}))}var p=V(V({},null!==s&&{extrudedHeight:s}),null!==c&&{height:c,perPositionHeight:!1});return V(V({},e),{},{primitive:V(V({},l),{},{geometry:null==a?void 0:a.positions},null!=l&&null!==(r=l.entity)&&void 0!==r&&r.polygon?{entity:{polygon:V(V({},null==l||null===(n=l.entity)||void 0===n?void 0:n.polygon),p)}}:p)})},circlePolyline:function(e){var t=e.feature,r=e.primitive,n=e.parsedSymbolizer;if("Point"===t.geometry.type){var i=a.Z.fromDegrees(t.geometry.coordinates[0],t.geometry.coordinates[1],t.geometry.coordinates[2]||0),o=ce(i,n);return V(V({},e),{},{primitive:V(V({},r),{},{geometry:[o]})})}return e},circlePolygon:function(e){var t=e.feature,r=e.primitive,n=e.parsedSymbolizer;if("Point"===t.geometry.type){var i=a.Z.fromDegrees(t.geometry.coordinates[0],t.geometry.coordinates[1],t.geometry.coordinates[2]||0),o=ce(i,n);return V(V({},e),{},{primitive:V(V({},r),{},{geometry:[o]})})}return e}},pe={Mark:function(e){var t,r=e.parsedSymbolizer,n=e.globalOpacity,i=e.images,o=e.symbolizer,a=i.find((function(e){return e.id===(0,j.kD)(r,o)}))||{},l=a.image,u=a.width,s=a.height,c=u>s?u:s,m=2*r.radius/c;return l?[{type:"point",geometryType:"point",entity:{billboard:{image:l,scale:m,rotation:d.Z.toRadians(-1*r.rotate||0),disableDepthTestDistance:r.msBringToFront?Number.POSITIVE_INFINITY:0,heightReference:g.Z[ae[r.msHeightReference]||"NONE"],color:Q({color:"#ffffff",opacity:1*n})}}}].concat(X(r.msLeaderLineWidth?[{type:"leaderLine",geometryType:"leaderLine",entity:{polyline:{material:Q({color:r.msLeaderLineColor||"#000000",opacity:(null!==(t=r.msLeaderLineOpacity)&&void 0!==t?t:1)*n}),width:r.msLeaderLineWidth}}}]:[])):[]},Icon:function(e){var t,r=e.parsedSymbolizer,n=e.globalOpacity,i=e.images,o=e.symbolizer,a=i.find((function(e){return e.id===(0,j.kD)(r,o)}))||{},l=a.image,u=a.width,s=a.height,c=u>s?u:s,m=r.size/c;return l?[{type:"point",geometryType:"point",entity:{billboard:V(V({image:l,scale:m},le(r.anchor)),{},{pixelOffset:r.offset?new f.Z(r.offset[0],r.offset[1]):null,rotation:d.Z.toRadians(-1*r.rotate||0),disableDepthTestDistance:r.msBringToFront?Number.POSITIVE_INFINITY:0,heightReference:g.Z[ae[r.msHeightReference]||"NONE"],color:Q({color:"#ffffff",opacity:r.opacity*n})})}}].concat(X(r.msLeaderLineWidth?[{type:"leaderLine",geometryType:"leaderLine",entity:{polyline:{material:Q({color:r.msLeaderLineColor||"#000000",opacity:(null!==(t=r.msLeaderLineOpacity)&&void 0!==t?t:1)*n}),width:r.msLeaderLineWidth}}}]:[])):[]},Text:function(e){var t,r,n,i,o=e.parsedSymbolizer,a=e.feature,l=e.globalOpacity,u=te(null==o||null===(t=o.offset)||void 0===t?void 0:t[0]),s=te(null==o||null===(r=o.offset)||void 0===r?void 0:r[1]);return[{type:"point",geometryType:"point",entity:{label:V(V({text:(0,j.xV)({properties:a.properties},o.label,""),font:[o.fontStyle,o.fontWeight,"".concat(o.size,"px"),S()(o.font||["serif"]).join(", ")].filter((function(e){return e})).join(" "),fillColor:Q({color:o.color,opacity:1*l})},le(o.anchor)),{},{disableDepthTestDistance:o.msBringToFront?Number.POSITIVE_INFINITY:0,heightReference:g.Z[ae[o.msHeightReference]||"NONE"],pixelOffset:new f.Z(null!=u?u:0,null!=s?s:0)},o.haloWidth>0&&{style:h.Z.FILL_AND_OUTLINE,outlineColor:Q({color:o.haloColor,opacity:1*l}),outlineWidth:o.haloWidth})}}].concat(X(o.msLeaderLineWidth?[{type:"leaderLine",geometryType:"leaderLine",entity:{polyline:{material:Q({color:o.msLeaderLineColor||"#000000",opacity:(null!==(n=o.msLeaderLineOpacity)&&void 0!==n?n:1)*l}),width:o.msLeaderLineWidth}}}]:[]),X(o.msLeaderLineWidth&&(u||s)?[{type:"offset",geometryType:"point",entity:{billboard:{image:ie(o),scale:1,pixelOffset:new f.Z((u||0)/2,(s||0)/2),color:Q({color:o.msLeaderLineColor||"#000000",opacity:(null!==(i=o.msLeaderLineOpacity)&&void 0!==i?i:1)*l})}}}]:[]))},Model:function(e){var t,r,n,i,o=e.parsedSymbolizer,a=e.globalOpacity;return null!=o&&o.model?[{type:"point",geometryType:"point",entity:{model:{uri:new T.Z({proxy:(0,I.$)(null==o?void 0:o.model)?new b.Z((0,I.b)()):void 0,url:null==o?void 0:o.model}),color:Q({color:null!==(t=o.color)&&void 0!==t?t:"#ffffff",opacity:(null!==(r=o.opacity)&&void 0!==r?r:1)*a}),scale:null!==(n=null==o?void 0:o.scale)&&void 0!==n?n:1,heightReference:g.Z[ae[o.msHeightReference]||"NONE"]}}}].concat(X(o.msLeaderLineWidth?[{type:"leaderLine",geometryType:"leaderLine",entity:{polyline:{material:Q({color:o.msLeaderLineColor||"#000000",opacity:(null!==(i=o.msLeaderLineOpacity)&&void 0!==i?i:1)*a}),width:o.msLeaderLineWidth}}}]:[])):[]},Line:function(e){var t,r,n=e.parsedSymbolizer,i=e.feature,o=e.globalOpacity,a=K(n),l=a?a(i):{};return[].concat(X(n.color&&0!==n.width?[{type:"polyline",geometryType:"polyline",entity:{polyline:V({material:null!=n&&n.dasharray?ee({color:n.color,opacity:n.opacity*o,dasharray:n.dasharray}):Q({color:n.color,opacity:n.opacity*o}),width:n.width,clampToGround:n.msClampToGround,arcType:n.msClampToGround?O.Z.GEODESIC:O.Z.NONE},l)}}]:[]),X(n.msClampToGround||!n.msExtrudedHeight||n.msExtrusionType?[]:[{type:"polylineVolume",geometryType:"wall",entity:{wall:{material:Q({color:n.msExtrusionColor||"#000000",opacity:(null!==(t=n.msExtrusionOpacity)&&void 0!==t?t:1)*o})}}}]),X(!n.msClampToGround&&n.msExtrudedHeight&&n.msExtrusionType?[{type:"polylineVolume",geometryType:"polyline",entity:{polylineVolume:{material:Q({color:n.msExtrusionColor||"#000000",opacity:(null!==(r=n.msExtrusionOpacity)&&void 0!==r?r:1)*o}),shape:ue(n.msExtrusionType,n.msExtrudedHeight/2)}}}]:[]))},Fill:function(e){var t=e.parsedSymbolizer,r=e.feature,n=e.globalOpacity,i=!t.msClampToGround&&!!t.msExtrudedHeight,o=K(t),a=o?o(r):{};return[{type:"polygon",geometryType:"polygon",clampToGround:t.msClampToGround,entity:{polygon:V(V({material:Q({color:t.color,opacity:t.fillOpacity*n}),perPositionHeight:!t.msClampToGround},t.msClampToGround?{classificationType:"terrain"===t.msClassificationType?P.Z.TERRAIN:"3d"===t.msClassificationType?P.Z.CESIUM_3D_TILE:P.Z.BOTH}:void 0),{},{arcType:t.msClampToGround?O.Z.GEODESIC:void 0},a)}}].concat(X(t.outlineColor&&0!==t.outlineWidth&&!i?[{type:"polyline",geometryType:"polyline",entity:{polyline:V(V({material:null!=t&&t.outlineDasharray?ee({color:t.outlineColor,opacity:t.outlineOpacity*n,dasharray:t.outlineDasharray}):Q({color:t.outlineColor,opacity:t.outlineOpacity*n}),width:t.outlineWidth,clampToGround:t.msClampToGround},t.msClampToGround?{classificationType:"terrain"===t.msClassificationType?P.Z.TERRAIN:"3d"===t.msClassificationType?P.Z.CESIUM_3D_TILE:P.Z.BOTH}:void 0),{},{arcType:t.msClampToGround?O.Z.GEODESIC:O.Z.NONE},a)}}]:[]))},Circle:function(e){var t=e.parsedSymbolizer,r=e.globalOpacity;return[{type:"polygon",geometryType:"circlePolygon",clampToGround:t.msClampToGround,entity:{polygon:V({material:Q({color:t.color,opacity:t.opacity*r})},t.geodesic?V(V({perPositionHeight:!t.msClampToGround},t.msClampToGround?{classificationType:"terrain"===t.msClassificationType?P.Z.TERRAIN:"3d"===t.msClassificationType?P.Z.CESIUM_3D_TILE:P.Z.BOTH}:void 0),{},{arcType:O.Z.GEODESIC}):{perPositionHeight:!0,arcType:void 0})}}].concat(X(t.outlineColor&&0!==t.outlineWidth?[{type:"polyline",geometryType:"circlePolyline",entity:{polyline:V({material:null!=t&&t.outlineDasharray?ee({color:t.outlineColor,opacity:t.outlineOpacity*r,dasharray:t.outlineDasharray}):Q({color:t.outlineColor,opacity:t.outlineOpacity*r}),width:t.outlineWidth},t.geodesic?V(V({clampToGround:t.msClampToGround},t.msClampToGround?{classificationType:"terrain"===t.msClassificationType?P.Z.TERRAIN:"3d"===t.msClassificationType?P.Z.CESIUM_3D_TILE:P.Z.BOTH}:void 0),{},{arcType:O.Z.GEODESIC}):{clampToGround:!1,arcType:O.Z.NONE})}}]:[]))}},de=function(e,t){e.msGeometry;var r=B(e,F),n=(t.msGeometry,B(t,_));return!M()(r,n)};const fe=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},(t=[{key:"readStyle",value:function(){return new Promise((function(e,t){try{e(null)}catch(e){t(e)}}))}},{key:"writeStyle",value:function(e){return new Promise((function(t,r){try{t(function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).rules,t=void 0===e?[]:e;return function(e){var r=e.opacity,n=void 0===r?1:r,i=e.features,o=e.getPreviousStyledFeature,a=void 0===o?function(){}:o,l=e.map,u=e.sampleTerrain,s=void 0===u?Z.Z:u;return(0,j.vg)({rules:t},{features:i}).then((function(e){var r=function(e){var t=e.rules,r=e.features,n=e.globalOpacity,i=e.images;return null==t?void 0:t.map((function(e){var t=r.filter((function(t){var r=t.properties;return!e.filter||(0,j.NG)({properties:r||{}},e.filter)}));return e.symbolizers.map((function(e){return t.filter((function(t){return function(e){var t=e.geometry,r=e.symbolizer;return!("Point"===t.type&&["Fill","Line"].includes(r.kind)||"LineString"===t.type&&["Fill"].includes(r.kind)||"Polygon"===t.type&&["Line"].includes(r.kind))}({geometry:t.geometry,symbolizer:e})})).map((function(t){var r=(0,j.mL)(e,t);return(pe[r.kind]?pe[r.kind]:function(){return[]})({feature:t,symbolizer:e,images:i,parsedSymbolizer:r,globalOpacity:n}).map((function(n){return{id:"".concat(t.id,":").concat(r.symbolizerId,":").concat(n.type),feature:t,primitive:n,symbolizer:e,parsedSymbolizer:r}}))})).flat()})).flat()})).flat()}({rules:t,features:i,globalOpacity:n,images:e});return Promise.all(r.map((function(e){var t,r,n,i,o,u,c=a(e);if(!c||(n=c.parsedSymbolizer,i=e.parsedSymbolizer,(null==n||null===(o=n.msGeometry)||void 0===o?void 0:o.name)!==(null==i||null===(u=i.msGeometry)||void 0===u?void 0:u.name)||(null==n?void 0:n.msHeight)!==(null==i?void 0:i.msHeight)||(null==n?void 0:n.msHeightReference)!==(null==i?void 0:i.msHeightReference)||(null==n?void 0:n.msExtrudedHeight)!==(null==i?void 0:i.msExtrudedHeight)||(null==n?void 0:n.msExtrusionRelativeToGeometry)!==(null==i?void 0:i.msExtrusionRelativeToGeometry)||(null==n?void 0:n.msExtrusionType)!==(null==i?void 0:i.msExtrusionType)||(null==n?void 0:n.msTranslateX)!==(null==i?void 0:i.msTranslateX)||(null==n?void 0:n.msTranslateY)!==(null==i?void 0:i.msTranslateY)||(null==n?void 0:n.heading)!==(null==i?void 0:i.heading)||(null==n?void 0:n.pitch)!==(null==i?void 0:i.pitch)||(null==n?void 0:n.roll)!==(null==i?void 0:i.roll))){var m,y,p=ye[null==e||null===(m=e.primitive)||void 0===m?void 0:m.geometryType]?ye[null==e||null===(y=e.primitive)||void 0===y?void 0:y.geometryType]:function(){return e};return Promise.resolve(p(e,{map:l,sampleTerrain:s})).then((function(e){return V(V({},e),{},{action:"replace"})}))}return Promise.resolve(V(V({},e),{},{primitive:V(V(V({},null==c?void 0:c.primitive),null==e?void 0:e.primitive),{},{geometry:null==c||null===(t=c.primitive)||void 0===t?void 0:t.geometry,entity:V({},Object.keys((null==e||null===(r=e.primitive)||void 0===r?void 0:r.entity)||{}).reduce((function(t,r){var n,i,o,a;return V(V({},t),{},Y({},r,V(V({},null==c||null===(n=c.primitive)||void 0===n||null===(i=n.entity)||void 0===i?void 0:i[r]),null==e||null===(o=e.primitive)||void 0===o||null===(a=o.entity)||void 0===a?void 0:a[r])))}),{}))}),action:de(c.parsedSymbolizer,e.parsedSymbolizer)?"update":"none"}))})))})).then((function(e){return e.filter((function(e){return!!e.primitive.geometry}))}))}}(e))}catch(e){r(e)}}))}}])&&W(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}()},507122:(e,t,r)=>{"use strict";r.d(t,{v:()=>c});var n=r(664632),i=r(894417),o=r(185447),a=r(196975);function l(e,t){if(e){if("string"==typeof e)return u(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var s=function(e){return["centerPoint","lineToArc","startPoint","endPoint"].includes(null==e?void 0:e.name)},c={cesium:function(e){var t=e.Cesium,r=function(e){if(null!=e&&e.positions)return{type:e.geometry.type,positions:null==e?void 0:e.positions[0]};var r=("Polygon"===e.geometry.type?e.geometry.coordinates[0]:e.geometry.coordinates).map((function(e){return t.Cartesian3.fromDegrees(e[0],e[1],e[2])}));return{type:e.geometry.type,positions:r}},n={centerPoint:function(e){var n,i=r(e),a=i.positions,s=i.type,c=a.map((function(e){var r=t.Cartographic.fromCartesian(e),n=r.longitude,i=r.latitude,o=r.height;return[t.Math.toDegrees(n),t.Math.toDegrees(i),o]}));if("LineString"===s){var m=a.reduce((function(e,r,n){return a[n+1]?e+t.Cartesian3.distance(r,a[n+1]):e}),0)/2,y=c.map((function(e,r){var n=a.filter((function(e,t){return t<r+1}));return[e[0],e[1],e[2],n.reduce((function(e,r,i){return n[i+1]?e+t.Cartesian3.distance(r,n[i+1]):e}),0)]})),p=y.find((function(e){return e[3]>m})),d=y.indexOf(p)-1,f=y[d],v=m-f[3],g=t.Cartographic.toCartesian(t.Cartographic.fromDegrees(f[0],f[1],f[2])),h=t.Cartesian3.normalize(t.Cartesian3.subtract(t.Cartographic.toCartesian(t.Cartographic.fromDegrees(p[0],p[1],p[2])),g,new t.Cartesian3),new t.Cartesian3);return{position:t.Cartesian3.add(g,t.Cartesian3.multiplyByScalar(h,v,new t.Cartesian3),new t.Cartesian3)}}var T,b=((0,o.Z)({type:"Polygon",coordinates:[[].concat((T=c,function(e){if(Array.isArray(e))return u(e)}(T)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(T)||l(T)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),[c[0]])]})||{}).geometry,O=c.reduce((function(e,t){return e+function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,l=[],u=!0,s=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);u=!0);}catch(e){s=!0,i=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw i}}return l}}(e,t)||l(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t,3)[2]}),0)/c.length,P=[b.coordinates[0],b.coordinates[1],O]||0;return{position:t.Cartographic.toCartesian((n=t.Cartographic).fromDegrees.apply(n,P))}},lineToArc:function(){return{arcType:t.ArcType.GEODESIC,perPositionHeight:void 0}},startPoint:function(e){return{position:r(e).positions[0].clone()}},endPoint:function(e){var t=r(e).positions;return{position:t["Polygon"===e.geometry.type?t.length-2:t.length-1].clone()}}};return function(e){var t=e.msGeometry;return s(t)&&n[null==t?void 0:t.name]?n[t.name]:null}},openlayers:function(e){var t=e.Point,r=e.LineString,o=e.Polygon,l=e.GeoJSON,u=e.getCenter,c=new l,m={centerPoint:function(e){return function(r){var o=r.getGeometry().getType();if(["Point","MultiPoint"].includes(o))return r.getGeometry();var l=e?e.getView().getProjection().getCode():"EPSG:3857",s=r.getGeometry();if(["LineString"].includes(o)){var m=JSON.parse(c.writeFeature(r,{dataProjection:"EPSG:4326",featureProjection:l})),y=(0,n.Z)(m)/2,p=(0,i.Z)(m,y),d=(0,a.reproject)(p.geometry.coordinates,"EPSG:4326",l);return new t([d.x,d.y])}var f=s.getExtent(),v=u(f);return new t(v)}},lineToArc:function(e){return function(t){var n=e?e.getView().getProjection().getCode():"EPSG:3857",i=t.getGeometry().getType();if("LineString"===i||"MultiPoint"===i){var l=t.getGeometry().getCoordinates();return l=(0,a.transformLineToArcs)(l.map((function(e){var t=(0,a.reproject)(e,n,"EPSG:4326");return[t.x,t.y]}))),new r(l.map((function(e){var t=(0,a.reproject)(e,"EPSG:4326",n);return[t.x,t.y]})))}if("Polygon"===i){var u=t.getGeometry().getCoordinates()[0];return u=(0,a.transformLineToArcs)(u.map((function(e){var t=(0,a.reproject)(e,n,"EPSG:4326");return[t.x,t.y]}))),new o([u.map((function(e){var t=(0,a.reproject)(e,"EPSG:4326",n);return[t.x,t.y]}))])}return t.getGeometry()}},startPoint:function(){return function(e){var r=e.getGeometry(),n=r.getType();if(["Point","MultiPoint"].includes(n))return e.getGeometry();var i="Polygon"===n?r.getCoordinates()[0]:r.getCoordinates();return i.length>1?new t(i[0]):null}},endPoint:function(){return function(e){var r=e.getGeometry(),n=r.getType();if(["Point","MultiPoint"].includes(n))return e.getGeometry();var i="Polygon"===n?r.getCoordinates()[0]:r.getCoordinates();return new t(i.length>3?i[i.length-("Polygon"===n?2:1)]:i[i.length-1])}}};return function(e,t,r){var n,i=e.msGeometry;if(s(i)&&m[null==i?void 0:i.name])return{geometry:m[i.name](r)};var o=(null==t?void 0:t.getGeometry)&&(null==t||null===(n=t.getGeometry())||void 0===n?void 0:n.getType());return["Mark","Icon"].includes(e.kind)&&["LineString","MultiLineString","Polygon","MultiPolygon"].includes(o)?{geometry:m.centerPoint(r)}:null}},geojson:function(){var e={centerPoint:function(e){if(["LineString"].includes(e.geometry.type)){var t=(0,n.Z)(e)/2;return(0,i.Z)(e,t).geometry.coordinates}return(0,o.Z)(e).geometry.coordinates},lineToArc:function(e){return"LineString"===e.geometry.type?(0,a.transformLineToArcs)(e.geometry.coordinates):"Polygon"===e.geometry.type?e.geometry.coordinates.map(a.transformLineToArcs):null},startPoint:function(e){return"Polygon"===e.geometry.type?e.geometry.coordinates[0][0]:"LineString"===e.geometry.type?e.geometry.coordinates[0]:null},endPoint:function(e){return"Polygon"===e.geometry.type?e.geometry.coordinates[0][e.geometry.coordinates[0].length-2]:"LineString"===e.geometry.type?e.geometry.coordinates[e.geometry.coordinates.length-1]:null}};return function(t){var r=t.msGeometry;return s(r)&&e[null==r?void 0:r.name]?e[r.name]:null}}}},540098:e=>{var t=Math.ceil,r=Math.max;e.exports=function(e,n,i,o){for(var a=-1,l=r(t((n-e)/(i||1)),0),u=Array(l);l--;)u[o?l:++a]=e,e+=i;return u}},747445:(e,t,r)=>{var n=r(540098),i=r(816612),o=r(418601);e.exports=function(e){return function(t,r,a){return a&&"number"!=typeof a&&i(t,r,a)&&(r=a=void 0),t=o(t),void 0===r?(r=t,t=0):r=o(r),a=void 0===a?t<r?1:-1:o(a),n(t,r,a,e)}}},396026:(e,t,r)=>{var n=r(747445)();e.exports=n}}]);